{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/disco_lu/link-share-pwa/app/auth/login/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { supabase } from '@/app/lib/supabase'\nimport { useAuth } from '@/app/context/auth'\n\nexport default function LoginPage() {\n  const [email, setEmail] = useState('')\n  const [code, setCode] = useState('')\n  const [isLoading, setIsLoading] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n  const [codeSent, setCodeSent] = useState(false)\n  const [showResetBanner, setShowResetBanner] = useState(false)\n  const router = useRouter()\n  const { session } = useAuth()\n\n  // Redirect if already logged in\n  useEffect(() => {\n    if (session) {\n      router.push('/')\n    }\n  }, [session, router])\n\n  const handleSendCode = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setIsLoading(true)\n    setError(null)\n    setShowResetBanner(false)\n\n    try {\n      const response = await fetch('/api/auth/generate-code', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ \n          email,\n          override: true // Always override rate limits for now\n        }),\n      })\n\n      const data = await response.json()\n      \n      if (!response.ok) {\n        if (response.status === 429 || data.error?.includes('rate limit')) {\n          setShowResetBanner(true)\n        }\n        throw new Error(data.error || 'Failed to send code')\n      }\n\n      setCodeSent(true)\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to send code')\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const handleResetLimits = async () => {\n    setIsLoading(true)\n    setError(null)\n\n    try {\n      const response = await fetch('/api/auth/reset-limits', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ email }),\n      })\n\n      const data = await response.json()\n      \n      if (!response.ok) {\n        throw new Error(data.error || 'Failed to reset limits')\n      }\n\n      setShowResetBanner(false)\n      setError('Rate limits have been reset. You can now request a new code.')\n      \n      // Automatically request a new code after reset\n      await handleSendCode(new Event('submit') as any)\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to reset limits')\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const handleVerifyCode = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setIsLoading(true)\n    setError(null)\n\n    try {\n      console.log('Verifying code for:', email)\n      console.log('Code to verify:', code)\n      \n      const response = await fetch('/api/auth/verify-code', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ \n          email,\n          code: code.trim() // Trim any whitespace\n        }),\n      })\n\n      const data = await response.json()\n      \n      if (!response.ok) {\n        console.error('Verification failed:', data)\n        throw new Error(data.error || 'Failed to verify code')\n      }\n\n      // If verification is successful, redirect to home\n      router.push('/')\n    } catch (err) {\n      console.error('Error verifying code:', err)\n      setError(err instanceof Error ? err.message : 'Failed to verify code')\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  // If already logged in, show loading state\n  if (session) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-600\"></div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-md w-full space-y-8\">\n        <div>\n          <h2 className=\"mt-6 text-center text-3xl font-extrabold text-gray-900\">\n            Sign in to your account\n          </h2>\n        </div>\n\n        {showResetBanner && (\n          <div className=\"bg-red-50 border-l-4 border-red-400 p-4\">\n            <div className=\"flex\">\n              <div className=\"flex-shrink-0\">\n                <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                  <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n                </svg>\n              </div>\n              <div className=\"ml-3\">\n                <p className=\"text-sm text-red-700\">\n                  Rate limit reached. Would you like to reset the limits?\n                </p>\n                <div className=\"mt-2\">\n                  <button\n                    type=\"button\"\n                    onClick={handleResetLimits}\n                    disabled={isLoading}\n                    className=\"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n                  >\n                    {isLoading ? 'Resetting...' : 'Reset Limits'}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        <form className=\"mt-8 space-y-6\" onSubmit={codeSent ? handleVerifyCode : handleSendCode}>\n          <div className=\"rounded-md shadow-sm -space-y-px\">\n            <div>\n              <label htmlFor=\"email\" className=\"sr-only\">\n                Email address\n              </label>\n              <input\n                id=\"email\"\n                name=\"email\"\n                type=\"email\"\n                autoComplete=\"email\"\n                required\n                className=\"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm\"\n                placeholder=\"Email address\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                disabled={codeSent}\n              />\n            </div>\n            {codeSent && (\n              <div>\n                <label htmlFor=\"code\" className=\"sr-only\">\n                  Verification code\n                </label>\n                <input\n                  id=\"code\"\n                  name=\"code\"\n                  type=\"text\"\n                  required\n                  className=\"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm\"\n                  placeholder=\"Enter 12-character code\"\n                  value={code}\n                  onChange={(e) => setCode(e.target.value)}\n                />\n              </div>\n            )}\n          </div>\n\n          {error && (\n            <div className=\"text-red-500 text-sm text-center\">{error}</div>\n          )}\n\n          <div>\n            <button\n              type=\"submit\"\n              disabled={isLoading}\n              className=\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\n            >\n              {isLoading ? (\n                <span className=\"absolute left-0 inset-y-0 flex items-center pl-3\">\n                  <svg\n                    className=\"animate-spin h-5 w-5 text-white\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    fill=\"none\"\n                    viewBox=\"0 0 24 24\"\n                  >\n                    <circle\n                      className=\"opacity-25\"\n                      cx=\"12\"\n                      cy=\"12\"\n                      r=\"10\"\n                      stroke=\"currentColor\"\n                      strokeWidth=\"4\"\n                    ></circle>\n                    <path\n                      className=\"opacity-75\"\n                      fill=\"currentColor\"\n                      d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n                    ></path>\n                  </svg>\n                </span>\n              ) : null}\n              {codeSent ? 'Verify Code' : 'Send Code'}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  )\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 419, "column": 0}, "map": {"version":3,"sources":["file:///Users/disco_lu/link-share-pwa/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0],"debugId":null}}]
}